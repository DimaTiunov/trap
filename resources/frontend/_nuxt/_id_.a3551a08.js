import{_ as N}from"./layout-sidebar.vue.30b2544d.js";import{d as E,A as F,o,a as r,b as s,s as I,f as n,u as e,D as j,F as b,r as P,t as c,h as m,_ as D,c as $,e as v,w as d,g as u,p as L,i as M,j as V,k as Y,l as z,m as x}from"./entry.8cc9a0a4.js";import{u as O}from"./fetch.18605a33.js";import{P as U}from"./page-header.301ae07f.js";import{h as q}from"./file-attachment.vue.44781509.js";import{u as W}from"./use-events.46f9c63f.js";import{u as X}from"./use-smtp.9d59c30f.js";import{P as w,W as G}from"./vue3-tabs-component.b41d65f1.js";import{a as J,T as f}from"./table-base.f52003cb.js";import{C as H}from"./code-snippet.b94075a7.js";import{F as K}from"./file-attachment.1b258e0a.js";import{I as B}from"./icon-svg.07e61883.js";import"./use-formats.c79ce0bd.js";function Q(a){return a.replace(/./gm,t=>t.match(/[a-z0-9\s]+/i)?t:`&#${t.charCodeAt(0)};`)}const Z={class:"smtp-page-preview"},ee={class:"smtp-page-preview__in"},te={class:"smtp-page-preview__device-in"},se=E({__name:"smtp-page-preview",props:{device:{default:"desktop"}},setup(a){const p=F(a.device);return(_,i)=>(o(),r("div",Z,[s("div",ee,[s("button",{class:I(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="mobile"}]),onClick:i[0]||(i[0]=h=>p.value="mobile")},[n(e(B),{class:"smtp-page-preview__btn-icon",name:"mobile-device"})],2),s("button",{class:I(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="tablet"}]),onClick:i[1]||(i[1]=h=>p.value="tablet")},[n(e(B),{class:"smtp-page-preview__btn-icon",name:"tablet-device"})],2),s("button",{class:I(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="desktop"}]),onClick:i[2]||(i[2]=h=>p.value="desktop")},[n(e(B),{class:"smtp-page-preview__btn-icon",name:"desktop-device"})],2)]),s("div",{class:I(["smtp-page-preview__device",{"smtp-page-preview__device--desktop":p.value==="desktop","smtp-page-preview__device--tablet":p.value==="tablet","smtp-page-preview__device--mobile":p.value==="mobile"}])},[s("div",te,[j(_.$slots,"default")])],2)]))}});const ae={class:"smtp-page-addresses"},ne={key:0,class:"smtp-page-addresses__item-name"},oe=E({__name:"smtp-page-addresses",props:{addresses:{}},setup(a){return(t,p)=>(o(),r("div",ae,[(o(!0),r(b,null,P(t.addresses,_=>(o(),r("div",{key:_.email,class:"smtp-page-addresses__item"},[_.name?(o(),r("span",ne,c(_.name),1)):m("",!0),s("span",null,c(_.email),1)]))),128))]))}});const A=D(oe,[["__scopeId","data-v-217deb6c"]]),le=a=>(L("data-v-253995a4"),a=a(),M(),a),de={ref:"main",class:"smtp-page"},pe={class:"smtp-page__main"},re={class:"smtp-page__header"},_e={class:"smtp-page__header-title"},ie={class:"smtp-page__header-meta"},ce={class:"smtp-page__header-date"},me={class:"smtp-page__sender"},ue={class:"smtp-page__sender-title"},ve={class:"smtp-page__sender-address"},he={class:"smtp-page__body"},ge=["innerHTML"],ye={class:"mb-5"},fe={class:"flex gap-x-3"},be=le(()=>s("h3",{class:"mb-3 font-bold"},"Email Headers",-1)),ke=E({__name:"smtp-page",props:{event:{},htmlSource:{}},setup(a){const t=a,p=F(t.htmlSource||t.event.payload.html),_=$(()=>[{title:"From",address:t.event.payload.from},{title:"To",address:t.event.payload.to},{title:"CC",address:t.event.payload.cc},{title:"BCC",address:t.event.payload.bcc},{title:"Reply to",address:t.event.payload.reply_to}]),i=$(()=>{var l,k;return((l=t.event.payload)==null?void 0:l.html)!==void 0&&((k=t.event.payload)==null?void 0:k.html)!==""}),h=$(()=>{var l,k;return((l=t.event.payload)==null?void 0:l.text)!==void 0&&((k=t.event.payload)==null?void 0:k.text)!==""}),g=$(()=>t.event.payload),S=$(()=>q(t.event.date).format("DD.MM.YYYY HH:mm:ss")),C=$(()=>Array.isArray(t.event.payload.attachments)?t.event.payload.attachments:Object.values(t.event.payload.attachments||{}));return(l,k)=>(o(),r("div",de,[s("main",pe,[s("header",re,[s("h2",_e,c(g.value.subject),1),s("div",ie,[s("span",ce,c(S.value),1)])]),s("section",me,[(o(!0),r(b,null,P(_.value,y=>(o(),r(b,null,[(o(!0),r(b,null,P(y.address,T=>(o(),r("div",{key:`${y.title}-${T.email}`,class:I(["smtp-page__sender-item",`smtp-page__sender-${y.title.toLowerCase()}`])},[s("div",ue,c(y.title),1),s("div",ve,[T.name?(o(),r(b,{key:0},[v(c(T.name)+" ["+c(T.email)+"] ",1)],64)):(o(),r(b,{key:1},[v(c(T.email),1)],64))])],2))),128))],64))),256))]),s("section",he,[n(e(G),{options:{useUrlFragment:!1}},{default:d(()=>[i.value?(o(),u(e(w),{key:0,id:"html-preview",name:"Preview",suffix:"<span class='smtp-page__body-tab-badge'>HTML</span>"},{default:d(()=>[n(e(se),{device:"tablet"},{default:d(()=>[s("div",{innerHTML:p.value},null,8,ge)]),_:1})]),_:1})):m("",!0),i.value?(o(),u(e(w),{key:1,name:"HTML"},{default:d(()=>[n(e(H),{language:"html",class:"max-w-full",code:l.event.payload.html},null,8,["code"])]),_:1})):m("",!0),h.value?(o(),u(e(w),{key:2,name:"Text"},{default:d(()=>[n(e(H),{language:"html",class:"max-w-full",code:l.event.payload.text},null,8,["code"])]),_:1})):m("",!0),C.value.length?(o(),u(e(w),{key:3,name:"Attachments",suffix:`<span class='smtp-page__body-tab-badge'>${C.value.length}</span>`},{default:d(()=>[s("section",ye,[s("div",fe,[(o(!0),r(b,null,P(C.value,y=>(o(),u(e(K),{key:y.id,"event-id":l.event.id,event:l.event,attachment:y},null,8,["event-id","event","attachment"]))),128))])])]),_:1},8,["suffix"])):m("",!0),n(e(w),{name:"Raw"},{default:d(()=>[n(e(H),{language:"html",code:l.event.payload.raw},null,8,["code"])]),_:1}),n(e(w),{name:"Tech Info"},{default:d(()=>[s("section",null,[be,n(e(J),null,{default:d(()=>[n(e(f),{title:"Id"},{default:d(()=>[v(c(l.event.payload.id),1)]),_:1}),n(e(f),{title:"Subject"},{default:d(()=>[v(c(l.event.payload.subject),1)]),_:1}),n(e(f),{title:"From"},{default:d(()=>[n(e(A),{addresses:l.event.payload.from},null,8,["addresses"])]),_:1}),n(e(f),{title:"To"},{default:d(()=>[n(e(A),{addresses:l.event.payload.to},null,8,["addresses"])]),_:1}),l.event.payload.cc.length?(o(),u(e(f),{key:0,title:"Cc"},{default:d(()=>[n(e(A),{addresses:l.event.payload.cc},null,8,["addresses"])]),_:1})):m("",!0),l.event.payload.bcc.length?(o(),u(e(f),{key:1,title:"Bcc"},{default:d(()=>[n(e(A),{addresses:l.event.payload.bcc},null,8,["addresses"])]),_:1})):m("",!0),l.event.payload.reply_to.length?(o(),u(e(f),{key:2,title:"Reply to"},{default:d(()=>[n(e(A),{addresses:l.event.payload.reply_to},null,8,["addresses"])]),_:1})):m("",!0)]),_:1})])]),_:1})]),_:1})])])],512))}});const $e=D(ke,[["__scopeId","data-v-253995a4"]]),{normalizeSmtpEvent:we}=X(),Se=E({components:{SmtpPage:$e,PageHeader:U},async setup(){const a=V(),t=Y(),p=z(),_=a.params.id,{events:i}=W(),{data:h,pending:g}=await O(i.getUrl(_),{headers:{"X-Auth-Token":p.$authToken.token},onResponse({response:S}){return S.data},onResponseError(){t.push("/404")},onRequestError(){t.push("/404")}},"$pRkmObBT4O");return{serverEvent:h,pending:g,eventId:_,html:`<iframe srcdoc="${Q(h.value.payload.html)}"/>`,clearEvent:()=>i.removeById(_)}},head(){return{title:`SMTP > ${this.eventId} | Buggregator`}},computed:{event(){return this.serverEvent?we(this.serverEvent):null}},methods:{onDelete(){this.clearEvent(),this.$router.push("/")}}});const R=a=>(L("data-v-de9d3edb"),a=a(),M(),a),Ce={class:"smtp-event"},Te={key:0,class:"smtp-event__loading"},Ae=R(()=>s("div",null,null,-1)),Ie=R(()=>s("div",null,null,-1)),Pe=R(()=>s("div",null,null,-1)),Ee=[Ae,Ie,Pe],He={class:"smtp-event__body"};function Be(a,t,p,_,i,h){const g=N,S=x("PageHeader"),C=x("SmtpPage");return o(),r("main",Ce,[n(S,{class:"smtp-event__head","button-title":"Delete event",onDelete:a.onDelete},{default:d(()=>[n(g,{to:"/"},{default:d(()=>[v("Home")]),_:1}),v(" /  "),n(g,{to:"/smtp"},{default:d(()=>[v("Smtp")]),_:1}),v(" /  "),n(g,{disabled:!0},{default:d(()=>[v(c(a.eventId),1)]),_:1})]),_:1},8,["onDelete"]),a.pending&&!a.event?(o(),r("div",Te,Ee)):m("",!0),s("div",He,[a.event?(o(),u(C,{key:0,event:a.event,"html-source":a.html},null,8,["event","html-source"])):m("",!0)])])}const qe=D(Se,[["render",Be],["__scopeId","data-v-de9d3edb"]]);export{qe as default};
